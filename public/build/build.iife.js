var D=(e,f,i)=>new Promise((y,m)=>{var _=s=>{try{d(i.next(s))}catch(g){m(g)}},S=s=>{try{d(i.throw(s))}catch(g){m(g)}},d=s=>s.done?y(s.value):Promise.resolve(s.value).then(_,S);d((i=i.apply(e,f)).next())});(function(e){"use strict";const f=(c,l)=>{const a=c.__vccOpts||c;for(const[p,t]of l)a[p]=t;return a},i={class:"screeningInfoArea"},y={class:"screeningInfoHeader"},m={key:0,class:"screeningInfoLoading"},_={key:1,class:"screeningInfoError"},S={key:2,class:"screeningInfoFields"},d={class:"screeningInfoField"},s={class:"screeningInfoFieldHeader"},g={key:0},V={key:1},F={class:"screeningInfoField"},I={class:"screeningInfoFieldHeader"},b={key:0},C={key:1},P={key:0,class:"screeningInfoFieldBody"},z={class:"screeningInfoField"},M={class:"screeningInfoFieldHeader"},x={key:0},L={key:1},w={class:"screeningInfoField"},A={class:"screeningInfoFieldHeader"},H={key:0},U={key:1},W={key:2},$={key:0,class:"screeningInfoFieldBody"},j={class:"screeningInfoField"},q={class:"screeningInfoFieldHeader"},G={key:0},J={key:1},K={key:2},Q={key:0,class:"screeningInfoFieldBody"},R=f({__name:"ScreeningInfo",props:{submission:{type:Object,required:!0}},setup(c){const{useLocalize:l}=pkp.modules.useLocalize,{useUrl:a}=pkp.modules.useUrl,{useFetch:p}=pkp.modules.useFetch,{t}=l(),o=c,n=e.ref({}),u=e.ref(!0),k=e.ref(null),{apiUrl:T}=a(`submissions/${o.submission.id}/screening`),{data:X,fetch:Y}=p(T);function E(){return D(this,null,function*(){u.value=!0,k.value=null;try{yield Y(),n.value=X.value||{}}catch(r){k.value="Failed to load screening data"}finally{u.value=!1}})}function Z(r){return r==="Okay"?"screeningStatusOkay":r!=null&&r.includes("Unable")?"screeningStatusNotOkay":"screeningStatusWarning"}return e.onMounted(()=>{E()}),e.watch(()=>o.submission.id,()=>{E()}),(r,ne)=>{var h,B,O;const v=e.resolveComponent("PkpSpinner");return e.openBlock(),e.createElementBlock("div",i,[e.createElementVNode("div",y,[e.createElementVNode("h2",null,e.toDisplayString(e.unref(t)("plugins.generic.scieloScreening.info.name")),1),e.createElementVNode("p",null,e.toDisplayString(e.unref(t)("plugins.generic.scieloScreening.info.description")),1)]),u.value?(e.openBlock(),e.createElementBlock("div",m,[e.createVNode(v)])):k.value?(e.openBlock(),e.createElementBlock("div",_,[e.createElementVNode("p",null,e.toDisplayString(k.value),1)])):(e.openBlock(),e.createElementBlock("div",S,[e.createElementVNode("div",d,[e.createElementVNode("div",s,[e.createElementVNode("span",{class:e.normalizeClass(n.value.statusMetadataEnglish?"screeningStatusOkay":"screeningStatusNotOkay")},null,2),n.value.statusMetadataEnglish?(e.openBlock(),e.createElementBlock("span",g,e.toDisplayString(e.unref(t)("plugins.generic.scieloScreening.info.metadataEnglishOkay")),1)):(e.openBlock(),e.createElementBlock("span",V,e.toDisplayString(e.unref(t)("plugins.generic.scieloScreening.info.metadataEnglishNotOkay",{missingMetadata:n.value.missingMetadataEnglish})),1))])]),e.createElementVNode("div",F,[e.createElementVNode("div",I,[e.createElementVNode("span",{class:e.normalizeClass(n.value.statusAffiliation?"screeningStatusOkay":"screeningStatusNotOkay")},null,2),n.value.statusAffiliation?(e.openBlock(),e.createElementBlock("span",b,e.toDisplayString(e.unref(t)("plugins.generic.scieloScreening.info.affiliationOkay")),1)):(e.openBlock(),e.createElementBlock("span",C,e.toDisplayString(e.unref(t)("plugins.generic.scieloScreening.info.affiliationNotOkay")),1))]),!n.value.statusAffiliation&&((h=n.value.authorsWithoutAffiliation)!=null&&h.length)?(e.openBlock(),e.createElementBlock("div",P,[e.createElementVNode("ul",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.value.authorsWithoutAffiliation,N=>(e.openBlock(),e.createElementBlock("li",{key:N},e.toDisplayString(N),1))),128))])])):e.createCommentVNode("",!0)]),e.createElementVNode("div",z,[e.createElementVNode("div",M,[e.createElementVNode("span",{class:e.normalizeClass(n.value.statusOrcid?"screeningStatusOkay":"screeningStatusNotOkay")},null,2),n.value.statusOrcid?(e.openBlock(),e.createElementBlock("span",x,e.toDisplayString(e.unref(t)("plugins.generic.scieloScreening.info.orcidOkay")),1)):(e.openBlock(),e.createElementBlock("span",L,e.toDisplayString(e.unref(t)("plugins.generic.scieloScreening.info.orcidNotOkay")),1))])]),e.createElementVNode("div",w,[e.createElementVNode("div",A,[e.createElementVNode("span",{class:e.normalizeClass(n.value.statusPDFs?"screeningStatusOkay":"screeningStatusNotOkay")},null,2),n.value.numPDFs===0?(e.openBlock(),e.createElementBlock("span",H,e.toDisplayString(e.unref(t)("plugins.generic.scieloScreening.info.noPDFs")),1)):n.value.numPDFs>1?(e.openBlock(),e.createElementBlock("span",U,e.toDisplayString(e.unref(t)("plugins.generic.scieloScreening.info.manyPDFs.header")),1)):(e.openBlock(),e.createElementBlock("span",W,e.toDisplayString(e.unref(t)("plugins.generic.scieloScreening.info.pdfsOkay")),1))]),n.value.numPDFs>1?(e.openBlock(),e.createElementBlock("div",$,[e.createElementVNode("ul",null,[e.createElementVNode("li",null,e.toDisplayString(e.unref(t)("plugins.generic.scieloScreening.info.manyPDFs.body")),1)])])):e.createCommentVNode("",!0)]),e.createElementVNode("div",j,[e.createElementVNode("div",q,[e.createElementVNode("span",{class:e.normalizeClass(Z(n.value.statusDocumentOrcids))},null,2),n.value.statusDocumentOrcids==="Okay"?(e.openBlock(),e.createElementBlock("span",G,e.toDisplayString(e.unref(t)("plugins.generic.scieloScreening.info.documentOrcidsOkay")),1)):(B=n.value.statusDocumentOrcids)!=null&&B.includes("Unable")?(e.openBlock(),e.createElementBlock("span",J,e.toDisplayString(e.unref(t)(`plugins.generic.scieloScreening.info.documentOrcids${n.value.statusDocumentOrcids}`)),1)):(e.openBlock(),e.createElementBlock("span",K,e.toDisplayString(e.unref(t)("plugins.generic.scieloScreening.info.documentOrcidsNotOkay.header")),1))]),n.value.statusDocumentOrcids&&n.value.statusDocumentOrcids!=="Okay"&&!((O=n.value.statusDocumentOrcids)!=null&&O.includes("Unable"))?(e.openBlock(),e.createElementBlock("div",Q,[e.createElementVNode("ul",null,[e.createElementVNode("li",null,e.toDisplayString(e.unref(t)("plugins.generic.scieloScreening.info.documentOrcidsNotOkay.body")),1)])])):e.createCommentVNode("",!0)])]))])}}},[["__scopeId","data-v-70183e9c"]]);pkp.registry.registerComponent("ScreeningInfo",R),pkp.registry.storeExtend("workflow",c=>{const l=c.store,{useLocalize:a}=pkp.modules.useLocalize,{t:p}=a();l.extender.extendFn("getMenuItems",(t,o)=>[...t,{key:"scieloScreening",label:p("plugins.generic.scieloScreening.info.name"),state:{primaryMenuItem:"scieloScreening"}}]),l.extender.extendFn("getPrimaryItems",(t,o)=>{var n;return((n=o==null?void 0:o.selectedMenuState)==null?void 0:n.primaryMenuItem)==="scieloScreening"?[{component:"ScreeningInfo",props:{submission:o.submission}}]:t})})})(pkp.modules.vue);
